<div {{ attributes }} class="max-w-xl mx-auto">
    {{ form_start(form, {
        attr: {'data-action': 'submit->live#action:prevent', 'data-live-action-param': 'save'},
    }) }}
        <twig:Field:Set>
            <twig:Field:Legend>API Credentials</twig:Field:Legend>
            <twig:Field:Description>Keep them secret!</twig:Field:Description>
            <twig:Field:Group>
                <twig:Dialog id="show_credentials">
                    <twig:Dialog:Trigger>
                        <twig:Button as="a" href="javascript:void(0)" variant="outline" {{ ...trigger_attrs }}>
                            <twig:ux:icon name="lucide:eye" />
                            Show the credentials
                        </twig:Button>
                    </twig:Dialog:Trigger>
                    <twig:Dialog:Content class="text-white max-w-2xl w-full">
                        {{ form_row(form.androidId) }}
                        {{ form_row(form.deviceToken) }}
                        {{ form_row(form.securityKey) }}
                        {{ form_row(form.deviceSecret) }}
                        <twig:Dialog:Footer class="sm:justify-between!">
                            <twig:Button
                                as="a"
                                href="javascript:void(0)"
                                variant="destructive"
                                data-action="live#action"
                                data-live-action-param="regenerateCredentials"
                            >
                                <twig:ux:icon name="lucide:trash" />
                                Regenerate
                            </twig:Button>
                            <twig:Dialog:Close>
                                <twig:Button type="button" variant="outline" {{ ...close_attrs }}>
                                    Close
                                </twig:Button>
                            </twig:Dialog:Close>
                        </twig:Dialog:Footer>
                    </twig:Dialog:Content>
                </twig:Dialog>
            </twig:Field:Group>
        </twig:Field:Set>

        <twig:Separator  class="my-12"/>

        <twig:Field:Set>
            <twig:Field:Legend>Notifications</twig:Field:Legend>
            <twig:Field:Description>Stay tuned!</twig:Field:Description>
            <twig:Field:Group>
               <div class="flex flex-col gap-3">
                   {{ form_label(form.discordWebhook) }}

                   <div class="flex flex-row items-center gap-x-2">
                       {{ form_widget(form.discordWebhook, {
                           row_attr: {
                               class: 'grow',
                           },
                       }) }}
                       <twig:Button
                           as="a"
                           variant="default"
                           data-action="live#action"
                           data-live-action-param="testDiscordWebhook"
                       >
                           <twig:ux:icon name="lucide:loader-circle" class="animate-spin" data-loading="show" />
                           <span data-loading="hide">Test</span>
                       </twig:Button>
                   </div>

                   {{ form_errors(form.discordWebhook) }}
               </div>
            </twig:Field:Group>
        </twig:Field:Set>

        <twig:Separator  class="my-12"/>

        <twig:Field:Set>
            <twig:Field:Legend>Actions</twig:Field:Legend>
            <twig:Field:Description>In case of emergency only!</twig:Field:Description>
            <twig:Field:Group>
                <twig:Field>
                    <div>
                        <twig:Button
                            as="a"
                            href="javascript:void(0)"
                            variant="outline"
                            data-action="live#action"
                            data-live-action-param="syncAllSeries"
                        >
                            <twig:ux:icon name="lucide:book-copy" />
                            Synchronize mangas
                        </twig:Button>
                    </div>
                </twig:Field>
                <twig:Field>
                    <div>
                        <twig:Button
                            as="a"
                            href="javascript:void(0)"
                            variant="outline"
                            data-action="live#action"
                            data-live-action-param="downloadChapters"
                        >
                            <twig:ux:icon name="lucide:download" />
                            Download new chapters
                        </twig:Button>
                    </div>
                </twig:Field>
            </twig:Field:Group>
        </twig:Field:Set>

        <twig:Separator  class="my-12"/>

        <twig:Field:Set>
            <twig:Field:Legend>Contact</twig:Field:Legend>
            <twig:Field:Description>To suggest new ideas, report bugs, etc...</twig:Field:Description>
            <twig:Field:Group>
                <twig:Field class="flex flex-row gap-2">
                    <a href="https://github.com/Treast/local-mangaplus" target="_blank"
                       class="group flex items-center gap-4 p-4 rounded-md border border-slate-800 bg-slate-900/50 transition-all hover:border-indigo-500/50 hover:bg-slate-900">
                        <div class="flex h-12 w-12 items-center justify-center rounded-full bg-slate-800 text-slate-100 group-hover:text-indigo-400">
                            <twig:ux:icon name="lucide:github" class="size-6" />
                        </div>
                        <div>
                            <h5 class="font-bold text-slate-100">GitHub</h5>
                            <p class="text-sm text-slate-500 mt-0">View source code</p>
                        </div>
                    </a>

                    <div x-data="{ copied: false }"
                         @click="navigator.clipboard.writeText('treast'); copied = true; setTimeout(() => copied = false, 2000)"
                         class="cursor-pointer group flex items-center gap-4 p-4 rounded-md border border-slate-800 bg-slate-900/50 transition-all hover:border-indigo-500/50 hover:bg-slate-900">
                        <div class="flex h-12 w-12 items-center justify-center rounded-full bg-slate-800 text-slate-100 group-hover:text-indigo-400">
                            <twig:ux:icon name="ic:baseline-discord" class="size-6" />
                        </div>
                        <div class="flex-1">
                            <h5 class="font-bold text-slate-100">Discord</h5>
                            <p class="text-sm text-slate-500 mt-0" x-text="copied ? 'Copied!' : 'treast'"></p>
                        </div>
                    </div>
                </twig:Field>
            </twig:Field:Group>
        </twig:Field:Set>

        <twig:Separator  class="my-12"/>

        <twig:Button type="submit" variant="outline" class="w-full">Save</twig:Button>
    {{ form_end(form) }}
</div>
